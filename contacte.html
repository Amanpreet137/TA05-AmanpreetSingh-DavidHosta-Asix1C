<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8" />
  <title>Contacte</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- CSS base (igual que index.html) -->
  <link rel="stylesheet" href="style.css" />
  <!-- CSS específico de contacte -->
  <link rel="stylesheet" href="contacte.css" />
</head>

<body class="page-contacte">

<header>
  <div class="header-top">
    <h1>Contacte</h1>
  </div>
  <nav>
    <ul>
      <li><a href="index.html">Inici</a></li>
      <li><a href="projectes.html">Projecte</a></li>
      <li><a href="contacte.html">contacte</a></li>
    </ul>
  </nav>
</header>

<main class="main-content">

  <h2 class="contacte-title">formulari de contacte:</h2>

  <form id="contactForm" class="contacte-form" novalidate>

    <div class="field full">
      <label for="nom">Nom i cognoms *</label>
      <input id="nom" name="nom" type="text" placeholder="Ex: Amanpreet Singh"
             required minlength="3" maxlength="60" />
      <small class="error"></small>
    </div>

    <div class="field half">
      <label for="email">Email *</label>
      <input id="email" name="email" type="email" placeholder="ex: nom@gmail.com" required />
      <small class="error"></small>
    </div>

    <div class="field half">
      <label for="telefon">Telèfon</label>
      <input id="telefon" name="telefon" type="tel" placeholder="Ex: 600123123" inputmode="tel" />
      <small class="error"></small>
    </div>

    <div class="field full">
      <label for="assumpte">Assumpte *</label>
      <input id="assumpte" name="assumpte" type="text"
             placeholder="Ex: Col·laboració / Entrevista"
             required minlength="4" maxlength="80" />
      <small class="error"></small>
    </div>

    <div class="field half">
      <label for="empresa">Empresa</label>
      <input id="empresa" name="empresa" type="text" placeholder="Ex: ITB / Empresa X" maxlength="60" />
      <small class="error"></small>
    </div>

    <div class="field half">
      <label for="missatge">Missatge *</label>
      <textarea id="missatge" name="missatge"
                placeholder="Escriu el teu missatge..."
                required minlength="15" maxlength="500"></textarea>
      <small class="error"></small>
    </div>

    <div class="actions">
      <div class="btns">
        <button type="submit" class="btn-send">Enviar</button>
        <button type="reset" class="btn-reset">Netejar</button>
      </div>

      <p id="formStatus" class="status" aria-live="polite"></p>
    </div>

  </form>

</main>

<footer>
  <p>© 2025 Amanpreet Singh · ASIX</p>
</footer>

<script>
  const form = document.getElementById("contactForm");
  const statusEl = document.getElementById("formStatus");

  const rules = {
    nom: { required: true, min: 3, max: 60 },
    email: { required: true, email: true },
    telefon: { phone: true },
    assumpte: { required: true, min: 4, max: 80 },
    empresa: { max: 60 },
    missatge: { required: true, min: 15, max: 500 }
  };

  function setError(input, msg){
    const f = input.closest(".field");
    f.classList.add("has-error");
    f.querySelector(".error").textContent = msg;
  }

  function clearError(input){
    const f = input.closest(".field");
    f.classList.remove("has-error");
    f.querySelector(".error").textContent = "";
  }

  function validEmail(v){
    return /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(v);
  }

  function validPhone(v){
    if(!v) return true;
    const d = v.replace(/[^\d]/g,"");
    return d.length >= 9 && d.length <= 15;
  }

  function validate(input){
    const name = input.name;
    const r = rules[name];
    if(!r) return true;

    const v = (input.value || "").trim();
    clearError(input);

    if(r.required && !v){
      setError(input, "Camp obligatori");
      return false;
    }
    if(r.min && v && v.length < r.min){
      setError(input, `Mínim ${r.min} caràcters`);
      return false;
    }
    if(r.max && v.length > r.max){
      setError(input, `Màxim ${r.max} caràcters`);
      return false;
    }
    if(r.email && v && !validEmail(v)){
      setError(input, "Email no vàlid");
      return false;
    }
    if(r.phone && v && !validPhone(v)){
      setError(input, "Telèfon no vàlid (9-15 dígits)");
      return false;
    }
    return true;
  }

  form.querySelectorAll("input, textarea").forEach(el=>{
    el.addEventListener("input", ()=>validate(el));
    el.addEventListener("blur", ()=>validate(el));
  });

  form.addEventListener("submit", (e)=>{
    e.preventDefault();
    statusEl.textContent = "";
    statusEl.className = "status";

    let ok = true;
    form.querySelectorAll("input, textarea").forEach(el=>{
      if(!validate(el)) ok = false;
    });

    if(!ok){
      statusEl.textContent = "Revisa els camps en vermell";
      statusEl.classList.add("bad");
      return;
    }

    statusEl.textContent = "Missatge enviat correctament ✅";
    statusEl.classList.add("ok");
    form.reset();
  });

  form.addEventListener("reset", ()=>{
    statusEl.textContent = "";
    statusEl.className = "status";
    form.querySelectorAll(".field").forEach(f=>f.classList.remove("has-error"));
    form.querySelectorAll(".error").forEach(er=>er.textContent="");
  });
</script>

</body>
</html>
